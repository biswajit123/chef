function reset_elements(){jQuery(".hideable").show();var e=jQuery("#interval_type").val();e&&jQuery("#interval_type_option_"+e).attr("selected",!0)}jQuery(document).ready(function(){var e=!1;jQuery("select.ajax_chosen_select_products_and_variations").change(function(){if(jQuery(this).find("option:selected").length>1){while(jQuery(this).find("option:selected").length>1)jQuery(jQuery(this).find("option:selected")[0]).remove();jQuery(this).trigger("liszt:updated")}jQuery("#use_custom_field").change()});jQuery("select.ajax_chosen_select_products_and_variations").ajaxChosen({method:"GET",url:ajaxurl,dataType:"json",afterTypeDelay:100,data:{action:"woocommerce_json_search_products_and_variations",security:FUE.nonce}},function(e){var t={};jQuery.each(e,function(e,n){t[e]=n});return t});jQuery("select.chzn-select").chosen();jQuery("#test_send").click(function(){var e={action:"sfn_test_email",type:jQuery("#email_type").val(),subject:jQuery("#email_subject").val(),message:tinyMCE.get("email_message")?tinyMCE.get("email_message").getContent():jQuery("#email_message").val(),email:jQuery("#test_email").val(),tracking:jQuery("#tracking").val()};jQuery.post(ajaxurl,e,function(){alert("Email sent!")})});jQuery(".help_tip").tipTip();jQuery("#email_type").live("change",function(){var e=jQuery(this).val();reset_elements();if(e=="generic"){var t=[".always_send_tr",".var_item_names",".var_item_categories",".interval_type_option",".interval_type_span",".var"],n=[".adjust_date_tr",".signup_description",".email_receipient_tr",".btn_send_save",".product_description_tr",".product_tr",".category_tr",".use_custom_field_tr",".custom_field_tr",".var_item_name",".var_item_category",".interval_type_order_total_above",".interval_type_order_total_below",".interval_type_purchase_above_one",".interval_type_total_purchases",".interval_type_total_orders",".interval_type_after_last_purchase",".var_customer"];for(r=0;r<t.length;r++)jQuery(t[r]).show();for(r=0;r<n.length;r++)jQuery(n[r]).hide();jQuery(".interval_type_option").remove();if(email_intervals&&email_intervals.generic.length>0)for(var r=0;r<email_intervals.generic.length;r++){var i=email_intervals.generic[r];jQuery("#interval_type").append('<option class="interval_type_option interval_type_'+i+'" id="interval_type_option_'+i+'" value="'+i+'">'+interval_types[i]+"</option>")}}if(e=="normal"){var t=[".always_send_tr",".interval_type_option",".interval_type_span",".product_description_tr",".product_tr",".category_tr",".use_custom_field_tr",".var"],n=[".adjust_date_tr",".var_item_names",".email_receipient_tr",".btn_send_save",".var_item_categories",".signup_description",".interval_type_order_total_above",".interval_type_order_total_below",".interval_type_purchase_above_one",".interval_type_total_purchases",".interval_type_total_orders",".interval_type_after_last_purchase",".var_customer"];for(r=0;r<t.length;r++)jQuery(t[r]).show();for(r=0;r<n.length;r++)jQuery(n[r]).hide();jQuery(".interval_type_option").remove();if(email_intervals&&email_intervals.normal.length>0)for(var r=0;r<email_intervals.normal.length;r++){var i=email_intervals.normal[r];jQuery("#interval_type").append('<option class="interval_type_option interval_type_'+i+'" id="interval_type_option_'+i+'" value="'+i+'">'+interval_types[i]+"</option>")}}if(e=="signup"){var t=[".interval_type_option",".signup_description",".var_item_name",".var_item_category",".var"],n=[".always_send_tr",".interval_type_span",".adjust_date_tr",".btn_send_save",".email_receipient_tr",".product_description_tr",".product_tr",".category_tr",".use_custom_field_tr",".var_item_name",".var_item_category",".var_item_names",".var_item_categories",".var_order_number",".var_order_datetime",".interval_type_order_total_above",".interval_type_order_total_below",".interval_type_purchase_above_one",".interval_type_after_last_purchase",".interval_type_total_purchases",".interval_type_total_orders",".interval_type_after_last_purchase",".var_customer"];for(r=0;r<n.length;r++)jQuery(n[r]).hide();jQuery(".interval_type_option").remove();if(email_intervals&&email_intervals.signup.length>0)for(var r=0;r<email_intervals.signup.length;r++){var i=email_intervals.signup[r];jQuery("#interval_type").append('<option class="interval_type_option interval_type_'+i+'" id="interval_type_option_'+i+'" value="'+i+'">'+interval_types[i]+"</option>")}}if(e=="manual"){var n=[".always_send_tr",".interval_tr",".adjust_date_tr",".product_description_tr",".product_tr",".category_tr",".use_custom_field_tr",".var_item_name",".var_item_category",".var_item_names",".var_item_categories",".var_order_number",".var_order_datetime",".interval_type_order_total_above",".interval_type_order_total_below",".interval_type_purchase_above_one",".interval_type_total_purchases",".interval_type_total_orders",".interval_type_after_last_purchase",".var_customer"];for(r=0;r<n.length;r++)jQuery(n[r]).hide();jQuery(".interval_type_option").remove();if(email_intervals&&email_intervals.manual.length>0)for(var r=0;r<email_intervals.manual.length;r++){var i=email_intervals.manual[r];jQuery("#interval_type").append('<option class="interval_type_option interval_type_'+i+'" id="interval_type_option_'+i+'" value="'+i+'">'+interval_types[i]+"</option>")}}if(e=="customer"){var t=[".always_send_tr",".interval_type_order_total_above",".interval_type_order_total_below",".interval_type_purchase_above_one",".interval_type_total_purchases",".interval_type_total_orders",".interval_type_total_purchases",".interval_type_after_last_purchase",".interval_type_span",".var_customer"],n=[".adjust_date_tr",".interval_type_option",".always_send_tr",".signup_description",".product_description_tr",".product_tr",".category_tr",".use_custom_field_tr",".custom_field_tr",".var_item_name",".var_item_category",".var_item_names",".var_item_categories",".var_item_name",".var_item_category",".interval_duration_date"];for(r=0;r<n.length;r++)jQuery(n[r]).hide();for(r=0;r<t.length;r++)jQuery(t[r]).show();jQuery(".interval_type_option").remove();if(email_intervals&&email_intervals.customer.length>0)for(var r=0;r<email_intervals.customer.length;r++){var i=email_intervals.customer[r];jQuery("#interval_type").append('<option class="interval_type_option interval_type_'+i+'" id="interval_type_option_'+i+'" value="'+i+'">'+interval_types[i]+"</option>")}}jQuery(".adjust_date_tr").hide();jQuery("body").trigger("fue_email_type_changed",[e]);if(jQuery("#interval_duration").val()=="date"){jQuery(".hide-if-date").hide();jQuery(".show-if-date").show()}else{jQuery(".hide-if-date").show();jQuery(".show-if-date").hide();e=="signup"&&jQuery(".interval_type_span").hide()}jQuery("#interval_type").val()!="order_total_above"?jQuery(".show-if-order_total_above").hide():jQuery(".show-if-order_total_above").show();jQuery("#interval_type").val()!="order_total_below"?jQuery(".show-if-order_total_below").hide():jQuery(".show-if-order_total_below").show();jQuery("#interval_type").val()!="total_orders"?jQuery(".show-if-total_orders").hide():jQuery(".show-if-total_orders").show();jQuery("#interval_type").val()!="total_purchases"?jQuery(".show-if-total_purchases").hide():jQuery(".show-if-total_purchases").show();jQuery("#interval_type option:selected").css("display")=="none"&&jQuery("#interval_type option").each(function(){if(jQuery(this).css("display")!="none"){jQuery("#interval_type").val(jQuery(this).val());return!1}});jQuery("#interval_type").val()=="after_last_purchase"&&jQuery(".adjust_date_tr").show()});jQuery("#email_type").change();jQuery("#tracking_on").change(function(){jQuery(this).attr("checked")?jQuery(".tracking_on").show():jQuery(".tracking_on").hide()}).change();jQuery("#interval_type").change(function(){jQuery(".adjust_date_tr").hide();jQuery(this).val()!="cart"?jQuery(".not-cart").show():jQuery(".not-cart").hide();jQuery(this).val()=="after_last_purchase"&&jQuery(".adjust_date_tr").show();jQuery(this).val()!="order_total_above"?jQuery(".show-if-order_total_above").hide():jQuery(".show-if-order_total_above").show();jQuery(this).val()!="order_total_below"?jQuery(".show-if-order_total_below").hide():jQuery(".show-if-order_total_below").show();jQuery(this).val()!="total_orders"?jQuery(".show-if-total_orders").hide():jQuery(".show-if-total_orders").show();jQuery(this).val()!="total_purchases"?jQuery(".show-if-total_purchases").hide():jQuery(".show-if-total_purchases").show();jQuery(this).val()=="total_orders"||jQuery(this).val()=="total_purchases"?jQuery(".meta_one_time_tr").show():jQuery(".meta_one_time_tr").hide();jQuery("body").trigger("fue_interval_type_changed",[jQuery(this).val()])}).change();jQuery("#interval_duration").change(function(){jQuery("#email_type").change()}).change();jQuery(".date").datepicker();jQuery("#use_custom_field").change(function(){if(jQuery(this).attr("checked")){jQuery(".show-if-custom-field").show();if(jQuery("#product_id option:selected").length==1){jQuery(".if-product-selected").show();jQuery(".if-no-product-selected").hide();var e=jQuery("#product_id option:selected");if(e.length==1){var t=jQuery("#custom_fields");jQuery(".show-if-cf-product-selected").show();jQuery(t).html("<option>Loading data...</option>");var n={action:"fue_get_custom_fields",id:jQuery(e).val()};jQuery.post(ajaxurl,n,function(e){var n=jQuery.parseJSON(e);jQuery(t).html("");var r="";for(obj in n)r+='<option value="'+obj+'">'+obj+"</option>";jQuery(t).html(r);jQuery("#custom_fields").change()})}else jQuery(".show-if-cf-product-selected").hide()}else{jQuery(".if-product-selected").hide();jQuery(".if-no-product-selected").show()}}else jQuery(".show-if-custom-field").hide()}).change();jQuery("#custom_fields").change(function(){if(jQuery(this).val()=="Select a product first.")return;jQuery(".show-if-cf-selected").show();jQuery("#custom_field").val("{cf "+jQuery("#product_id option:selected").val()+" "+jQuery(this).val()+"}")}).change();jQuery("#sfn_form").submit(function(t){if(e==0){jQuery("#save").val(FUE.processing_request).attr("disabled",!0);var n={action:"sfn_fe_find_dupes",type:jQuery("#email_type").val(),interval:jQuery("#interval").val(),interval_duration:jQuery("#interval_duration").val(),interval_type:jQuery("#interval_type").val(),product_id:jQuery("#product_id").val(),category_id:jQuery("#category_id").val(),always_send:jQuery("#always_send").is(":checked")?1:0};jQuery.post(ajaxurl,n,function(t){jQuery(".sfn-error").remove();if(t=="DUPE"){jQuery('<div class="message error sfn-error"><p>'+FUE.dupe+"</p></div>").insertAfter("#sfn_form h3");jQuery("html, body").animate({scrollTop:jQuery(jQuery(".sfn-error")[0]).offset().top-50},1e3)}else if(t=="SIMILAR"){if(confirm(FUE.similar)){e=!0;jQuery("#sfn_form").submit()}}else{e=!0;jQuery("#sfn_form").submit()}jQuery("#save").val(FUE.save).attr("disabled",!1)});return!1}return!0})});